.\" last modified 2016-02-11
.\" Dorai Sitaram
.
.\" don't load if not groff
.
.if !\n(.g .nx
.
.\" don't load more than once
.
.if d eval4troff:process_snippets .nx
.
.if '\*[AUXF]'' .ds AUXF .trofftemp
.
.if '\*[pca-eval-lang]'' .ds pca-eval-lang lisp
.
.mso pca-eval-\*[pca-eval-lang].tmac
.
.nr eval4troff:already_setup 0
.
.de eval4troff:setup
.  if \\n[eval4troff:already_setup] .return
.  nr eval4troff:already_setup 1
.  nr eval4troff:count 0
.  if !\\n[.U] .return
.  eval4troff:process_snippets
.  open eval4troff:port \\*[eval4troff:file]
.  eval4troff:start_snippets
..
.
.ds eval4troff:status try
.
.de eval
.  eo
.  de eval4troff:text endeval
..
.
.de endeval
.  ec
.  eval4troff:so_snippet
.  if !\\n[.U] .return
.  eval4troff:write_snippet
..
.
.de eval4troff:so_snippet
.  eval4troff:setup
.  nr eval4troff:count +1
.  ds eval4troff:snippet_file \\*[AUXF]_eval_\\n[eval4troff:count].tmp
.  if !'\\*[eval4troff:status]'rerun' \{\
.    nr eval4troff:systat 0
.    if \\n[.U] \{\
.      sy test -f \\*[eval4troff:snippet_file]
.      nr eval4troff:systat \\n[systat]
.    \}
.    if !\\n[eval4troff:systat] \{\
.      so \\*[eval4troff:snippet_file]
.      if '\\*[eval4troff:status]'done' .return
.    \}
.    ds eval4troff:status rerun
.    if !\\n[.troff2page] .tm Rerun groff with -U
.  \}
\[rh]eval\[lh]
..
